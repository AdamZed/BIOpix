package movement;

/**
 * @version 1.1.0
 */

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class AngleDrawingTool extends JComponent {

	private static final long serialVersionUID = 1L;
	private Image image;
	private Graphics2D g2;
	private Pair current = new Pair();
	private Pair first = new Pair();
	private Pair second = new Pair();
	private Pair third = new Pair();
	AngleCalculator angler = new AngleCalculator();
	boolean firstLine = true;
	boolean load = false;

	public AngleDrawingTool() {
		setDoubleBuffered(false);
		addMouseListener(new MouseAdapter() {
			public void mousePressed(MouseEvent e) {
				if (firstLine)
					first.setBoth(e.getX(), e.getY());
			}
		});

		addMouseMotionListener(new MouseMotionAdapter() {
			public void mouseDragged(MouseEvent e) {
				clear();
				current.setBoth(e.getX(), e.getY());
				if (firstLine)
					g2.drawLine(first.getX(), first.getY(), current.getX(), current.getY());
				else {
					g2.drawLine(first.getX(), first.getY(), second.getX(), second.getY());
					g2.drawLine(second.getX(), second.getY(), current.getX(), current.getY());
				}
			}
		});

		addMouseListener(new MouseAdapter() {
			public void mouseReleased(MouseEvent e) {
				if (firstLine) {
					second.setBoth(current.getX(), current.getY());
					g2.drawLine(first.getX(), first.getY(), second.getX(), second.getY());
					firstLine = false;
				} else {
					third.setBoth(current.getX(), current.getY());
					g2.drawLine(first.getX(), first.getY(), second.getX(), second.getY());
					g2.drawLine(second.getX(), second.getY(), third.getX(), third.getY());
					System.out.println(angler.getAngle(first, third, second));
				}
			}
		});

	}

	protected void paintComponent(Graphics g) {
		if (image == null) {
			image = createImage(getSize().width, getSize().height);
			g2 = (Graphics2D) image.getGraphics();
			g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

			clear();
		}
		g.drawImage(image, 0, 0, null);

		if (load) {
			g2.drawLine(first.getX(), first.getY(), second.getX(), second.getY());
			g2.drawLine(second.getX(), second.getY(), third.getX(), third.getY());
			System.out.println(angler.getAngle(first, third, second));
			load = false;
		}
	}

	// clear canvas (sets canvas white [subject to change])
	public void clear() {
		g2.setPaint(Color.white);
		// draw white on entire draw area to clear
		g2.fillRect(0, 0, getSize().width, getSize().height);
		g2.setPaint(Color.black);
		repaint();
	}

	public void loadAngle(Pair first, Pair second, Pair third) {
		this.first = first;
		this.second = second;
		this.third = third;
		load = true;
	}

}
